<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.layout.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.control.Menu?>
<?import javafx.scene.control.MenuBar?>
<?import javafx.scene.control.MenuItem?>
<?import javafx.scene.control.SeparatorMenuItem?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ColorPicker?>
<?import javafx.scene.control.ComboBox?>
<?import javafx.collections.FXCollections?>

<GridPane xmlns="http://javafx.com/javafx/8" xmlns:fx="http://javafx.com/fxml/1"
          fx:controller="com.mongraphe.graphui.Graph"
          stylesheets="@../css/visualisation.css">
    
    <!-- Configuration des colonnes et lignes -->
    <columnConstraints>
        <ColumnConstraints percentWidth="20" />
        <ColumnConstraints percentWidth="60" />
        <ColumnConstraints percentWidth="20" />
    </columnConstraints>
    <rowConstraints>
        <RowConstraints prefHeight="25" maxHeight="25" /> <!-- Barre de menus -->
        <RowConstraints prefHeight="35" maxHeight="35" /> <!-- Barre d'onglets -->
        <RowConstraints percentHeight="100" /> <!-- Contenu principal -->
    </rowConstraints>

    
   <!-- Barre de menus (ligne 0) -->
    <MenuBar GridPane.columnSpan="3" GridPane.rowIndex="0">
        <Menu text="Fichier">
            <MenuItem text="Nouveau" />
            <MenuItem text="Ouvrir..." />
            <MenuItem text="Enregistrer" />
            <SeparatorMenuItem />
            <MenuItem text="Quitter" onAction="#handleQuit" />
        </Menu>
        <Menu text="Édition">
            <MenuItem text="Annuler" />
            <MenuItem text="Rétablir" />
        </Menu>
        <Menu text="Affichage">
            <MenuItem text="Plein écran" />
            <CheckMenuItem text="Afficher les statistiques" />
        </Menu>
        <Menu text="Outils">
            <MenuItem text="Options..." />
        </Menu>
        <Menu text="Fenêtre">
            <MenuItem text="Disposition" />
        </Menu>
        <Menu text="Aide">
            <MenuItem text="Documentation" />
            <MenuItem text="À propos..." onAction="#handleAbout" />
        </Menu>
    </MenuBar>

  <!-- Barre d'onglets -->
    <HBox GridPane.columnSpan="3" GridPane.rowIndex="1" 
          style="-fx-background-color: #f4f4f4; -fx-padding: 5;" 
          spacing="10">
        <fx:define>
            <ToggleGroup fx:id="viewToggleGroup"/>
        </fx:define>
        
        <ToggleButton text="Vue d'ensemble" 
                 styleClass="custom-toggle"
                 toggleGroup="$viewToggleGroup"
                 onAction="#handleViewChange"
                 userData="overview"
                 selected="true"/>
        <ToggleButton text="Laboratoire de Données" 
                    styleClass="custom-toggle"
                    toggleGroup="$viewToggleGroup"
                    onAction="#handleViewChange"
                    userData="data"/>
        <ToggleButton text="Prévisualisation" 
                    styleClass="custom-toggle"
                    toggleGroup="$viewToggleGroup"
                    onAction="#handleViewChange"
                    userData="preview"/>
    </HBox>

    <!-- Conteneur principal (ligne 2) -->
    <StackPane fx:id="mainContentPane" GridPane.columnSpan="3" GridPane.rowIndex="2">
        <!-- Vue d'ensemble -->
        <GridPane fx:id="overviewPane" visible="true">
            <columnConstraints>
                <ColumnConstraints percentWidth="20" />
                <ColumnConstraints percentWidth="60" />
                <ColumnConstraints percentWidth="20" />
            </columnConstraints>
            <rowConstraints>
                <RowConstraints percentHeight="30" />
                <RowConstraints percentHeight="60" />
            </rowConstraints>


            <!-- Panneau gauche haut -->
            <AnchorPane style="-fx-border-color: grey; -fx-border-width: 1px;" 
                        GridPane.rowIndex="0" GridPane.columnIndex="0">
                <VBox spacing="10" style="-fx-padding: 10;">
                    <!-- Titre "Aspect du graphe" -->
                    <Label text="Aspect du graphe" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
                    
                    <!-- ToggleButtons pour Noeuds/Arêtes -->
                    <HBox spacing="5">
                    <fx:define>
                    <ToggleGroup fx:id="elementToggleGroup"/>
                </fx:define>
                        <ToggleButton text="Noeuds" toggleGroup="$elementToggleGroup" userData="NODES" selected="true" onAction="#handleToggleNodes"/>
                        <ToggleButton text="Arêtes" toggleGroup="$elementToggleGroup" userData="EDGES" onAction="#handleToggleEdges"/>
                    </HBox>
                    
                    <!-- Contenu dynamique -->
                    <VBox spacing="8">
                        <!-- Sélection de couleur -->
                        <HBox spacing="5" alignment="CENTER_LEFT">
                            <Label text="Couleur:"/>
                            <ColorPicker fx:id="elementColorPicker" prefWidth="120"/>
                        </HBox>
                        
                        <!-- Classement -->
                        <HBox spacing="5" alignment="CENTER_LEFT">
                            <Label text="Classement:"/>
                            <ComboBox fx:id="elementRankingCombo" prefWidth="120" />
                        </HBox>
                    </VBox>
                    
                    <!-- Bouton Appliquer en bas à droite -->
                    <HBox alignment="BOTTOM_RIGHT">
                        <Button text="Appliquer" onAction="#handleApply" 
                                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
                        <Button text="Démarrer" onAction="#handleStartButton"
                        style="-fx-opacity: 1; -fx-disabled-opacity: 1;"
                        AnchorPane.topAnchor="10" AnchorPane.leftAnchor="10" />
                    </HBox>
                </VBox>
            </AnchorPane>

            <AnchorPane style="-fx-border-color: grey; -fx-border-width: 1px;" 
                        GridPane.rowIndex="1" GridPane.columnIndex="0">
                <VBox spacing="10" style="-fx-padding: 10;">
                    <Label text="Paramètres du graphe" style="-fx-font-weight: bold; -fx-font-size: 14;" />

                    <!-- Slider pour modifier le degré minimum des nœuds -->
                    <HBox spacing="5" alignment="CENTER_LEFT">
                        <Label text="Degré Min:" />
                        <Slider fx:id="degreeMinSlider" min="0" max="100" value="3" blockIncrement="1" />
                        <Label fx:id="degreeMinValue" text="3" />
                    </HBox>
                    
                    <!-- Bouton Appliquer -->
                    <Button text="Appliquer" onAction="#applyMinDegree"
                            style="-fx-background-color: #4CAF50; -fx-text-fill: white;" />

                    <!-- Filtrage par taille des nœuds -->
<!--                     <HBox spacing="5" alignment="CENTER_LEFT">
                        <Label text="Filtrer Taille:" />
                        <ComboBox fx:id="sizeFilterComboBox">
                            <items>
                                <FXCollections fx:factory="observableArrayList">
                                    <String fx:value="Tous" />
                                    <String fx:value="Petits" />
                                    <String fx:value="Moyens" />
                                    <String fx:value="Grands" />
                                </FXCollections>
                            </items>
                        </ComboBox>
                    </HBox> -->

                    <!-- Affichage des nœuds isolés -->
<!--                     <CheckBox fx:id="showIsolatedNodesCheckbox" text="Afficher nœuds isolés" selected="true"/>
 -->
                    <!-- Bouton de réinitialisation -->
<!--                     <Button text="Réinitialiser" onAction="#resetGraphSettings"
                            style="-fx-background-color: #d9534f; -fx-text-fill: white;" /> -->
                </VBox>
            </AnchorPane>

            <!-- Panneau central -->
           <BorderPane fx:id="graphContentPane" 
           style="-fx-border-color: #FF5733; -fx-border-width: 2px; -fx-background-color: transparent;" 
           GridPane.rowIndex="0" GridPane.columnIndex="1" 
           GridPane.rowSpan="2">
            <bottom>
                <HBox spacing="10" alignment="CENTER" style="-fx-padding: 10;">
                    <fx:define>
                        <ToggleGroup fx:id="graphModeToggleGroup"/> 
                    </fx:define>

                    <RadioButton text="Exécution (RUN)" 
                                toggleGroup="$graphModeToggleGroup"
                                userData="RUN"
                                selected="true"
                                onAction="#handleApplyGraphMode"/>
                    <RadioButton text="Sélection (SELECTION)" 
                                toggleGroup="$graphModeToggleGroup"
                                userData="SELECTION"
                                onAction="#handleApplyGraphMode"/>
                    <RadioButton text="Déplacement (MOVE)" 
                                toggleGroup="$graphModeToggleGroup"
                                userData="MOVE"
                                onAction="#handleApplyGraphMode"/>
                    <RadioButton text="Suppression (DELETE)" 
                                toggleGroup="$graphModeToggleGroup"
                                userData="DELETE"
                                onAction="#handleApplyGraphMode"/>
                </HBox>
            </bottom>
            <center>
                <ScrollPane fx:id="graphScrollPane" fitToWidth="true" fitToHeight="true" 
                        hbarPolicy="AS_NEEDED" vbarPolicy="AS_NEEDED">
                    <AnchorPane fx:id="graphContainer" />
                </ScrollPane>
            </center>
        </BorderPane>

            <!-- Panneau droit -->
            <!-- Panneau des statistiques en haut à droite -->
        <AnchorPane style="-fx-border-color: grey; -fx-border-width: 1px; -fx-background-color: #ffffff; -fx-padding: 10;" 
                    GridPane.rowIndex="0" GridPane.columnIndex="2">
            <!-- Section statistiques -->
            <VBox alignment="TOP_CENTER" spacing="8" style="-fx-background-color: #f9f9f9; -fx-padding: 1; -fx-border-radius: 5; -fx-border-color: #ccc; -fx-border-width: 1px;" 
                AnchorPane.topAnchor="0" AnchorPane.bottomAnchor="0" AnchorPane.leftAnchor="0" AnchorPane.rightAnchor="0">
                <Label text="📊 Statistiques du Graphe" style="-fx-font-weight: bold; -fx-font-size: 14; -fx-text-fill: #333;" />
                <Separator />
                <HBox spacing="10">
                    <Label text="Nœuds affichés:" style="-fx-font-weight: bold;" />
                    <Label fx:id="nodesDisplayedLabel" text="0" style="-fx-text-fill: #2a9d8f;" />
                </HBox>
                <HBox spacing="10">
                    <Label text="Nœuds supprimés:" style="-fx-font-weight: bold;" />
                    <Label fx:id="nodesDeletedLabel" text="0" style="-fx-text-fill: #e76f51;" />
                </HBox>
                <HBox spacing="10">
                    <Label text="Arêtes affichées:" style="-fx-font-weight: bold;" />
                    <Label fx:id="edgesDisplayedLabel" text="0" style="-fx-text-fill: #2a9d8f;" />
                </HBox>
                <HBox spacing="10">
                    <Label text="Arêtes supprimées:" style="-fx-font-weight: bold;" />
                    <Label fx:id="edgesDeletedLabel" text="0" style="-fx-text-fill: #e76f51;" />
                </HBox>
                <Separator />
                <HBox spacing="10">
                    <Label text="Total éléments:" style="-fx-font-weight: bold;" />
                    <Label fx:id="totalElementsLabel" text="0" style="-fx-text-fill: #264653; -fx-font-size: 14;" />
                </HBox>
            </VBox>
        </AnchorPane>
        </GridPane>

        <!-- Vue Données -->
        <AnchorPane fx:id="dataPane" visible="false">
            <!-- Contenu des données -->
        </AnchorPane>

        <!-- Vue Prévisualisation -->
        <AnchorPane fx:id="previewPane" visible="false">
            <!-- Contenu de prévisualisation -->
        </AnchorPane>
    </StackPane>
</GridPane>